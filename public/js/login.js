angular.module("ov.services.login",["ov.constant","ov.services.utils"]).service("loginService",["$rootScope","$location","$http","Util","MSG.ERROR.CODE","LOGINED",function(e,o,n,t,r){function i(){var e="/api/login";location.href=e}function s(o,i,s){var l=(new Date).getTime(),c=t.object.toUrlencodedString(o);n.post("/api/login/student?_="+l,c,{responseType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(o,n){0===o.err?window.location="/overall.html":e.$emit(r,o.err),i&&i(o,n)}).error(function(e,o){s&&s(e,o)})}return{teacherLogin:i,studentLogin:s}}]),angular.module("ov.services.utils",[]).service("Util",[function(){var e={object:{toUrlencodedString:function(e){return _.map(e,function(e,o){return encodeURIComponent(o)+"="+encodeURIComponent(e)}).join("&")}},getParameter:function(e){var o=new RegExp("(\\?|#|&)"+e+"=([^&#]*)(&|#|$)"),n=location.href.match(o);return decodeURIComponent(n?n[2]:"")},cookie:{get:function(e){var o=document.cookie.split("; "),n=_.reduce(o,function(e,o){var n=o.split("=");return e[n[0]]=n[1],e},{});return n[e]},set:function(e){var o=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),t=0;t<n.length;t++){var r=$.trim(n[t]);if(r.substring(0,e.length+1)==e+"="){o=decodeURIComponent(r.substring(e.length+1));break}}return o}},time:{timezoneOffset:(new Date).getTimezoneOffset(),dateToDatetimePickerValue:function(o,n){return o||(o=new Date),o.setMinutes(o.getMinutes()-e.time.timezoneOffset),n||(o.setSeconds(0),o.setMilliseconds(0)),o.toISOString().split(".")[0]},datetimePickerValueToTs:function(o){if(o){var n=o.split(":").length<3?":00.000Z":".000Z",t=Date.parse(o+n)+60*e.time.timezoneOffset*1e3;return console.log(o,t,new Date(t)),t}return 0}}};return e}]),angular.module("ov.controllers.login",["ov.constant","ov.services.utils","ov.services.login"]).controller("loginController",["$rootScope","$scope","Util","loginService",function(e,o,n,t){console.log("load toolbarController"),o.username="",o.pwd="",o.studentLogin=function(){t.studentLogin({name:o.username,id:o.pwd})}}]),angular.module("ov.controllers.msg",["ov.constant"]).controller("msgController",["$rootScope","$scope","MSG.ERROR.CODE",function(e,o,n){console.log("load msgcontroller"),Messenger().options={extraClasses:"messenger-fixed messenger-on-bottom",theme:"flat"};var t={0:"操作成功!",1001:"您还没有登录!",1004:"没有找到资源!",1010:"您没有查看该资源的权限!",1011:"参数出错啦!",1013:"出错啦",1014:"同名啦,请修改名称!",1015:"已经归档啦!",1016:"该资源不能删除",1017:"该目录下还有其他文件，无法删除!",1041:"用户名或密码错误!",1043:"用户不存在!",1050:"时间交叉了!"};e.$on(n,function(e,o){var n={message:t[o]};parseInt(o)&&(n.type="error"),Messenger().post(n)})}]),function(){angular.module("login",["ov.controllers.login","ov.controllers.msg"])}();